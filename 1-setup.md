# Setup

To use Scala in a productive manner, the use of SBT (Scala Build Tool) is encouraged. SBT is an interactive environment in which one can compile, test and run Scala projects quickly, independent of their size and complexity. It also serves as a package manager for including libraries without having to download them manually. SBT contains a console inside it, where you can test out pieces of code if you're not sure what they would yield when added to your projects.

### Project Basics

To get started, we can create a minimal Scala project by running:

```bash
> sbt new pllab/scala.g8
```
When you run this command, it will ask you for some minimal details (name, package and version) after which a project folder will be generated for you.

You will be presented by a new folder with the name that you input (for the tutorial, we'll use the name `hello-world` and the organization `cs160.tuts`. The structure of the folder will be as follows:

```
hello-world
├── build.sbt
└── src
    ├── main
    │   └── scala
    │       └── Main.scala
    └── test
        └── scala
            └── EmptySpec.scala
```
This structure is the default one expected by SBT and contains the **build file** (`build.sbt`) and the **source** directory (`src`). The source directory contains two further folders: `main` and `test`, that respectively hold the code of the project and the tests of the projects. 

SBT can handle projects that combine multiple languages, which is why both of these folders explicitly say that we are using `scala`; both `scala` folders contain only `scala` source files. Richer and different hierarchies can be used, but must be configured in the build file.

Running `sbt` from the command line inside the generated project folder opens the interactive SBT shell. This will be useful to have around, so be sure to keep it open all the time while developing your program. The basic Scala development environment includes an **editor** of your choice to write the code in, and the **SBT shell**. To separate the console prompt from the SBT shell prompt, it is prefixed with your project name:

```bash 
> sbt

sbt:hello-world> 
```
Without going into the actual Scala code of our project (which was generated by `sbt new`) or what tests we have for this project, we can compile our project by typing `compile`, and test it by typing `test` into the sbt shell.

```sbt
sbt:hello-world> compile
[success] Total time: 1 s, completed Sep 12, 2018 1:58:59 AM
sbt:hello-world> 
```
The tests include only an empty test suite for this project, so we won't go deeper into that topic right now.

```sbt
sbt:hello-world> test
[info] EmptySpec:
[info] ScalaTest
[info] Run completed in 239 milliseconds.
[info] Total number of tests run: 0
[info] Suites: completed 1, aborted 0
[info] Tests: succeeded 0, failed 0, canceled 0, ignored 0, pending 0
[info] No tests were executed.
[info] Passed: Total 0, Failed 0, Errors 0, Passed 0
[success] Total time: 1 s, completed Sep 12, 2018 1:58:41 AM
sbt:hello-world> 
```
> The actual output might vary, depending on how recently the code was changed and how many dependencies have to be reloaded.

No matter how large your project gets, the usage of SBT stays the same overall. There are additional commands which might come in useful, including `reload` for when the build file changes, `console` to run an interactive scala console inside SBT, and `exit` to leave SBT. You shouldn't have to restart SBT even once while developing your projects. If new files are added to the `src/` folder hierarchy, SBT will notice them next time you run a command and recompile with them.

### Scala REPL

Scala contains an interactive console (otherwise known as a REPL, or read-evaluate-print-loop), where you can type valid (or invalid!) Scala expressions and get them to immediately evaluate instead of being compiled.

By typing `console` into the SBT shell, we get the following:
```sbt
sbt:hello-world> console
[info] Updating ...
[info] Done updating.
[info] Compiling 1 Scala source to /home/mika/hello-world/target/scala-2.11/classes ...
[info] Done compiling.
[info] Starting scala interpreter...
import cs162.tutorials.hello-world._
Welcome to Scala version 2.11.5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_171).
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
```
This is yet another prompt, markedly stating that it is a pure `scala>` console. You can try out snippets of Scala code here, before deciding to include them in your code for good. From here, we can call any Scala code directly, so we could try out any expression:

```sbt
scala> 3+3
res0: Int = 6

scala> 
```
We can also try a `println` statement or a method call, such as `Main.main`. Don't be intimidated while in the console, you can try out things here with no reprecussions until they get to work. Reading the error messages is instrumental to understanding a language. Scala tries to give informative error messages, sometimes even going above and beyond the call of duty to give suggestions. 

We can return from this Scala REPL to the SBT one by pressing `CTRL+D`.

```sbt
scala>      <user hits CTRL+D> 
[success] Total time: 5032 s, completed Sep 12, 2018 2:27:04 AM
sbt:hello-world> exit
[info] shutting down server
```
### A note on multiline code in the Scala REPL

By default, the REPL allows only single lines of code, and evaluates after them. To fix this and write (or paste!) multiple lines into the REPL, type `:paste` when you start it. After that, it will allow multiline input when needed.

## Asciicast

To see all of this in practice, follow this asciicast for a step-by-step illustration of the process, done on a CSIL machine.

[![asciicast](https://asciinema.org/a/202735.png)](https://asciinema.org/a/202735)
