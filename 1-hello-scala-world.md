# Hello Scala World

## Introduction 

> **Note:** Segments formatted this way offer helpful advice and hints. Be sure to pay attention to them.

The goal of these tutorials is to give you an experience of how to think about, test and structure Scala code. They will introduce and explain most of the features commonly used by Scala developers and act as a backup stash of examples if ever stuck with any future projects.

For this introductory tutorial, we will be looking at a program that simply prints a message to the screen using Scala. You will learn about `Scala` as a language, and how to use `SBT`, Scala's build tool, to make your life easier. You will be using this setup for any project you do, so be sure to understand it and be comfortable with it.

> All of the tutorials have accompanying Scala files that you can change and play with. Some of them are used by more than one tutorial. The name of the file will always be listed in a comment at the beginning of any code listing associated with it.

## The Scala Language Environment

Scala (scalable+language) is a statically-typed mixed object-oriented and functional language.

> **Statically-typed**. Statically-typed languages do *type checking* (the process of verifying and enforcing the constraints of types) when the code compiles. Because of this, many errors get caught before the program is ever run, providing a higher level of safety. Many scripting languages (e.g. Python, Ruby, PHP) are dynamically-typed, meaning that errors concerning types appear when the programs are run.

> **Object-oriented language**. A paradigm of programming that models an application or system as a set of objects that can be connected and used in a modular manner. Objects can be in many sorts of relations, including inheritance (one object extends all the properties of another, potentially adding its own), composition (an object contains an instance of another object as a part of itself), etc. Object-oriented languages include Java, C++, Ruby, Python, and many others.

> **Functional language**. A paradigm of programming that builds the structure and elements of computer programs as the evaluation of functions and avoids changing state and mutable data. Functional languages often insist that the output of any function should depend only on its inputs and no other state. These properties align functional languages with mathematical logic. Many functional features are now common in mainstream languages (map/reduce, higher-order functions, lambdas, etc.), and are more and more common in the industry (via Javascript, Java, C#, Haskell and similar).

Scala is a language built on top of the JVM (Java Virtual Machine) and is thus compatible with Java.

To use Scala in a productive manner, the use of SBT (Scala Build Tool) is encouraged. SBT is an interactive environment in which one can compile, test and run Scala projects quickly, independent of their size and complexity. It also serves as a package manager for including libraries without having to download them manually. SBT contains a console inside it, where you can test out pieces of code if you're not sure what they would yield when added to your projects.

### Getting Started

To get started, we can create a minimal Scala project by running:

```bash
> sbt new fayimora/basic-scala-project.g8
```

> The command `sbt new` makes a new project out of a template, in this case, a basic scala project template at the `fayimora/basic-scala-project.g8` URL. The only reason we're using this specific template is because it very closely matches the very basic setup that is needed for this class.

The template requires some details to be added, which you will do accordingly:

```bash
> sbt new fayimora/basic-scala-project.g8
A basic scala project 

name [Basic Project]: <input project name here>
organization [com.example]: <input organization here>
version [0.0.1]: <input version number here>
```
It's advisable to fill out these as best you can, so that you don't get lost in your own projects. The version number and organization is not important for the course itself. The **name** of the project will be the name of the folder generated by SBT, so pay attention to that field!

> The first time SBT runs, it will download all necessary dependencies and compile them. This might take a while, but happens only the first time around. Be patient, the output might look scary, but should end up at the same place.

### Project Structure

After you've finished the above steps, you will be presented by a new folder with the name that you input (for the tutorial, we'll use the name `helloworld` and the organization `cs160.tutorials`. The structure of the folder will be as follows:

```
helloworld
├── build.sbt
└── src
    ├── main
    │   └── scala
    │       └── Main.scala
    └── test
        └── scala
            └── EmptySpec.scala
```
This structure is the default one expected by SBT and contains the **build file** (`build.sbt`) and the **source** directory (`src`). The source directory contains two further folders: `main` and `test`, that respectively hold the code of the project and the tests of the projects. 

SBT can handle projects that combine multiple languages, which is why both of these folders explicitly say that we are using `scala`; both `scala` folders contain only `scala` source files. Richer and different hierarchies can be used, but must be configured in the build file.

### Build File Basics

The SBT template generated a simple build file, similar to this one:

```sbt
name := "helloworld"

organization := "cs160.tutorials"

version := "0.0.1"

scalaVersion := "2.11.5"

libraryDependencies ++= Seq(
  "org.scalatest" %% "scalatest" % "2.2.1" % "test" withSources() withJavadoc(),
  "org.scalacheck" %% "scalacheck" % "1.12.1" % "test" withSources() withJavadoc()
)

initialCommands := "import cs160.tutorials.helloworld._"
```
Mostly self-explanatory, the SBT file contains the data about our project (the name, organization and version that we input above), the preferred Scala version to use with the project, as well as what dependencies we will be using (for the tutorial, these will always include the `scalatest` and `scalacheck` testing libraries). The last line sets up the SBT console so that the code from our project is preloaded into it.

Running `sbt` from the command line inside the generated project folder opens the interactive SBT shell. This will be useful to have around, so be sure to keep it open all the time while developing your program. The basic Scala development environment includes an **editor** of your choice to write the code in, and the **SBT shell**. To separate the console prompt from the SBT shell prompt, it is prefixed with your project name:

```bash 
> sbt

sbt:helloworld> 
```
Without going into the actual Scala code of our project (which was generated by `sbt new`) or what tests we have for this project, we can test our project by typing `test` into the sbt shell, compile it without running by typing `compile`, or run it by typing `run`.

```sbt
sbt:helloworld> test
[info] EmptySpec:
[info] ScalaTest
[info] Run completed in 239 milliseconds.
[info] Total number of tests run: 0
[info] Suites: completed 1, aborted 0
[info] Tests: succeeded 0, failed 0, canceled 0, ignored 0, pending 0
[info] No tests were executed.
[info] Passed: Total 0, Failed 0, Errors 0, Passed 0
[success] Total time: 1 s, completed Sep 12, 2018 1:58:41 AM
sbt:helloworld> 
```
```sbt
sbt:helloworld> compile
[success] Total time: 1 s, completed Sep 12, 2018 2:03:02 AM
sbt:helloworld> 
```
```sbt
sbt:helloworld> run
[info] Packaging /cs/student/mvg/helloworld/target/scala-2.11/helloworld_2.11-0.0.1.jar ...
[info] Done packaging.
[info] Running cs162.tutorials.helloworld.Main
Hello World!
[success] Total time: 2 s, completed Sep 12, 2018 1:59:21 AM
sbt:helloworld> 
```
> The actual output might vary, depending on how recently the code was changed and how many dependencies have to be reloaded.

No matter how large your project gets, the usage of SBT stays the same overall. There are additional commands which might come in useful, including `reload` for when the build file changes, `console` to run the aforementioned scala console inside SBT, and `exit` to leave SBT. You shouldn't have to restart SBT even once while developing your projects. If new files are added to the `src/` folder hierarchy, SBT will notice them next time you run a command and recompile with them.

### Hello World in Scala

We can now open the `src/main/scala/Main.scala` and look at its contents. We know that it prints "Hello World!" from looking at the `run` output above. The code reads:

```scala
package cs162.tutorials.helloworld

object Main {

  def main(args: Array[String]): Unit =
    println("Hello World!")
}
```
Let's go through this code line by line: the first line declares that the contents of the `Main.scala` file are part of the `cs162.tutorials.helloworld` package. `object Main` declares that an object exists (just a singleton object called main), and then within this object we have a method called `main`. This is the equivalent to the `main` function from C or Java, which acts as an entrypoint when running the program.

Let's take a closer look at the type of this method: `def main(args: Array[String]): Unit` means that it takes a single argument of type `Array[String]` (read "array of strings") called `args`, and returns a `Unit` value. For now, you can imagine `Unit` as `void` from C or Java. We will come back to explain the difference in a [later tutorial](#). As in those other languages, the main entrypoint of the program _must_ have this exact type for the program to execute. SBT will recognize the entrypoint method by name and type alone.

Being a functional language, every function and method is defined by what it does, and is equal to that process. That's why we can write that the `main` method is _equal_ to a call to `println("Hello World!")`: it does exactly that and nothing else.

> When a function or a method needs to do more things, the code of the function can be put into curly braces:
```scala
 def main(args: Array[String]): Unit = {
   println("Hello")
   println("World!")
 }
```
> It is worth remembering that even though this _looks_ like what you might be used to coming from C/C++, the meaning is slightly different and will be explored in a [later tutorial](#).

# Scala Interpreter Console

We can see how this method works from the console as well. By typing `console` into the SBT shell, we get the following:
```sbt
sbt:helloworld> console
[info] Updating ...
[info] Done updating.
[info] Compiling 1 Scala source to /home/mika/helloworld/target/scala-2.11/classes ...
[info] Done compiling.
[info] Starting scala interpreter...
import cs162.tutorials.helloworld._
Welcome to Scala version 2.11.5 (Java HotSpot(TM) 64-Bit Server VM, Java 1.8.0_171).
Type in expressions to have them evaluated.
Type :help for more information.

scala> 
```
This is yet another console, this time one for using Scala as an interpreter. You can try out snippets of Scala code here, before deciding to include them in your code for good. From here, we can call any Scala code directly, so we could try out any expression:

```sbt
scala> 3+3
res0: Int = 6

scala> 
```
We can also try a `println` statement or a method call, such as `Main.main`. Don't be intimidated while in the console, you can try out things here with no reprecussions until they get to work.

```sbt
scala> Main.main
<console>:11: error: missing arguments for method main in object Main;
follow this method with `_' if you want to treat it as a partially applied function
              Main.main
                   ^

scala>
```
Reading the error messages is instrumental to understanding a language. Scala tries to give informative error messages, sometimes even going above and beyond the call of duty to give suggestions. We need to pass actual arguments, and in this case it needs to be an array of strings (as we know from the code). Passing an empty array will work, and in Scala this can be written as:
```sbt
scala> Main.main(Array())
Hello World!

scala> 
```

We can return from this Scala interpreter console to the SBT one by pressing `CTRL+D`.

```sbt
scala>      <user hits CTRL+D> 
[success] Total time: 5032 s, completed Sep 12, 2018 2:27:04 AM
sbt:helloworld> exit
[info] shutting down server
```

This concludes our first tutorial on Scala, where the main point was getting used to the environment and seeing the basic usecase of SBT in Scala development. Feel free to return to this at any point when you're feeling unsure of how to work in the Scala development environment.
